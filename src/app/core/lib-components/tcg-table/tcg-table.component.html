<div class="pt-dark-text">
  <div class="row">
    <div class="col col-xs-12 col-md-6">
      <div class="row">
        <div class="col col-md-1 p-0">
          <mat-menu #tableListMenu="matMenu">
            <mat-selection-list #selectedColumns [ngModel]="displayedColumns" (ngModelChange)="displayedColumnChange($event);">
              <mat-list-option *ngFor="let column of columns" [value]="column.key" (click)="$event.stopPropagation()">{{column.name}}</mat-list-option>
            </mat-selection-list>
          </mat-menu>
          <button mat-icon-button [matMenuTriggerFor]="tableListMenu" matTooltip="Change Displayed Columns" [matTooltipPosition]="'right'">
            <mat-icon><i class="fa fa-ellipsis-v"></i></mat-icon>
          </button>
        </div>
        <div *ngIf="!isAdvanceSearch" class="col col-md-10 p-0">
            <mat-form-field appearance="outline">
              <mat-label>Search</mat-label>
              <a matSuffix><mat-icon>search</mat-icon></a>
              <input matInput (keyup)="applySearch()" [(ngModel)]="searchBy">
            </mat-form-field>
        </div>
        <div *ngIf="canAdvanceSearch" class="col col-md-1 p-0">
            <button mat-icon-button (click)="toggleAdvanceSearch()" matTooltip="Toggle advance search" [matTooltipPosition]="'left'">
              <mat-icon *ngIf="!isAdvanceSearch"><i class="fa fa-angle-double-down fa-sm"></i></mat-icon>
              <mat-icon *ngIf="isAdvanceSearch"><i class="fa fa-angle-double-up fa-sm"></i></mat-icon>
            </button>
        </div>
      </div>
    </div>
    <div class="col col-xs-6 col-md-6"></div>
  </div>

  <div >
<!--
    <table class="mat-elevation-z8 table table-sm table-striped table-hover" mat-table [dataSource]="dataSource" matSort>
-->
    <table  mat-table [dataSource]="dataSource" matSort class="mat-elevation-z4">

      <span *ngFor="let column of columns">
        <ng-container matColumnDef="{{column.key}}">
          <span *ngIf="column.key == 'select'">
            <th mat-header-cell *matHeaderCellDef>
              <mat-checkbox (change)="$event ? masterToggle() : null"
                [checked]="selection.hasValue() && isAllSelected()"
                [indeterminate]="selection.hasValue() && !isAllSelected()">
              </mat-checkbox>
            </th>
            <td mat-cell *matCellDef="let row">
              <mat-checkbox (click)="$event.stopPropagation()"
                (change)="rowToggle($event, row);"
                [checked]="selection.isSelected(row)">
              </mat-checkbox>
            </td>
          </span>
          <span *ngIf="column.key != 'select'">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              <span *ngIf="!isAdvanceSearch">{{column.name}}</span>
              <div *ngIf="isAdvanceSearch">
                <mat-form-field appearance="outline">
                  <mat-label>{{column.name}}</mat-label>
                  <input matInput (keyup)="applySearch()" [(ngModel)]="advanceSearch[column.key]">
                </mat-form-field>
                <!--<span class="advance-search-logic" (click)="toggleAdvanceSearchLogic($event)">{{advanceSearchLogic}}</span>-->
              </div>
            </th>
            <td mat-cell *matCellDef="let row"> {{row[column.key]}} </td>
          </span>
        </ng-container>
      </span>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="rowClicked.emit(row)"></tr>
    </table>

    <mat-paginator *ngIf="!infiniteScroll" [pageSizeOptions]="pageSizes" class="mat-elevation-z4"></mat-paginator>
    <div *ngIf="infiniteScroll && isLoading" #loadingDiv class="mat-elevation-z4 table-loading"><mat-spinner diameter="20"></mat-spinner></div>
  </div>
</div>
